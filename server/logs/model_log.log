2023-04-19T22:12:56,198 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Listening on port: /tmp/.ts.sock.9000
2023-04-19T22:12:56,200 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Successfully loaded /home/vish/miniconda3/lib/python3.9/site-packages/ts/configs/metrics.yaml.
2023-04-19T22:12:56,200 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [PID]11160
2023-04-19T22:12:56,201 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Torch worker started.
2023-04-19T22:12:56,201 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Python runtime: 3.9.12
2023-04-19T22:12:56,207 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Connection accepted: /tmp/.ts.sock.9000.
2023-04-19T22:12:56,220 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - model_name: inpaint, batchSize: 1
2023-04-19T22:12:58,232 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - LISTING DIR:  ['.gitignore', 'mask.py', 'tshandler.py', 'davis.py', 'predict.py', '.dockerignore', 'image', 'lib', 'demo_retarget.py', 'cp', 'model.py', 'E2FGVI', 'models', 'train_git.py', 'cog.yaml', 'test.py', 'get_mask', 'Dockerfile', 'config.properties', 'serverREADME.md', 'requirements.txt', 'install.sh', 'server.py', 'logs', 'inpaint.py']
2023-04-19T22:12:58,232 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Created a temporary directory at /tmp/tmp7w89pfbq
2023-04-19T22:12:58,233 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Writing /tmp/tmp7w89pfbq/_remote_module_non_scriptable.py
2023-04-19T22:12:58,992 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - loading
2023-04-19T22:12:58,992 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-19 22:12:58,992-rk0-load_helper.py# 31] load pretrained model from ./server/cp/SiamMask_DAVIS.pth
2023-04-19T22:12:58,992 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - load pretrained model from ./server/cp/SiamMask_DAVIS.pth
2023-04-19T22:12:59,963 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - remove prefix 'module.'
2023-04-19T22:12:59,963 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-19 22:12:59,963-rk0-load_helper.py# 25] remove prefix 'module.'
2023-04-19T22:12:59,964 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-19 22:12:59,964-rk0-load_helper.py# 18] used keys:356
2023-04-19T22:12:59,964 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - used keys:356
2023-04-19T22:13:00,004 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [2023-04-19 22:13:00,004] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.9.0, git-hash=unknown, git-branch=unknown
2023-04-19T22:13:00,005 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [2023-04-19 22:13:00,004] [INFO] [logging.py:96:log_dist] [Rank -1] quantize_bits = 8 mlp_extra_grouping = False, quantize_groups = 1
2023-04-19T22:13:00,007 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [2023-04-19 22:13:00,007] [INFO] [comm.py:570:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
2023-04-19T22:13:00,008 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Backend worker process died.
2023-04-19T22:13:00,008 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Traceback (most recent call last):
2023-04-19T22:13:00,008 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_service_worker.py", line 221, in <module>
2023-04-19T22:13:00,008 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     worker.run_server()
2023-04-19T22:13:00,008 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_service_worker.py", line 189, in run_server
2023-04-19T22:13:00,008 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     self.handle_connection(cl_socket)
2023-04-19T22:13:00,009 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_service_worker.py", line 154, in handle_connection
2023-04-19T22:13:00,009 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     service, result, code = self.load_model(msg)
2023-04-19T22:13:00,009 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_service_worker.py", line 118, in load_model
2023-04-19T22:13:00,009 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     service = model_loader.load(
2023-04-19T22:13:00,010 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_loader.py", line 135, in load
2023-04-19T22:13:00,010 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     initialize_fn(service.context)
2023-04-19T22:13:00,010 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/tmp/models/2dc519fc2172452fb5c1893911371a30/tshandler.py", line 52, in initialize
2023-04-19T22:13:00,010 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     siammask = deepspeed.init_inference(
2023-04-19T22:13:00,011 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/deepspeed/__init__.py", line 324, in init_inference
2023-04-19T22:13:00,011 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     engine = InferenceEngine(model, config=ds_inference_config)
2023-04-19T22:13:00,011 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/deepspeed/inference/engine.py", line 165, in __init__
2023-04-19T22:13:00,011 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     self._create_model_parallel_group(config)
2023-04-19T22:13:00,011 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/deepspeed/inference/engine.py", line 264, in _create_model_parallel_group
2023-04-19T22:13:00,011 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     init_distributed()
2023-04-19T22:13:00,011 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/deepspeed/comm/comm.py", line 576, in init_distributed
2023-04-19T22:13:00,012 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     mpi_discovery(distributed_port=distributed_port, verbose=verbose)
2023-04-19T22:13:00,012 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/deepspeed/comm/comm.py", line 595, in mpi_discovery
2023-04-19T22:13:00,013 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     from mpi4py import MPI
2023-04-19T22:13:00,013 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - ModuleNotFoundError: No module named 'mpi4py'
2023-04-19T22:13:01,762 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Listening on port: /tmp/.ts.sock.9000
2023-04-19T22:13:01,765 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Successfully loaded /home/vish/miniconda3/lib/python3.9/site-packages/ts/configs/metrics.yaml.
2023-04-19T22:13:01,765 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [PID]11239
2023-04-19T22:13:01,765 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Torch worker started.
2023-04-19T22:13:01,766 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Python runtime: 3.9.12
2023-04-19T22:13:01,767 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Connection accepted: /tmp/.ts.sock.9000.
2023-04-19T22:13:01,776 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - model_name: inpaint, batchSize: 1
2023-04-19T22:13:07,515 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - LISTING DIR:  ['.gitignore', 'mask.py', 'tshandler.py', '__pycache__', 'davis.py', 'predict.py', '.dockerignore', 'image', 'lib', 'demo_retarget.py', 'cp', 'model.py', 'E2FGVI', 'models', 'train_git.py', 'cog.yaml', 'test.py', 'get_mask', 'Dockerfile', 'config.properties', 'serverREADME.md', 'requirements.txt', 'install.sh', 'server.py', 'logs', 'inpaint.py']
2023-04-19T22:13:07,515 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Created a temporary directory at /tmp/tmp2e9c5a_j
2023-04-19T22:13:07,516 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Writing /tmp/tmp2e9c5a_j/_remote_module_non_scriptable.py
2023-04-19T22:13:08,284 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - loading
2023-04-19T22:13:08,284 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-19 22:13:08,283-rk0-load_helper.py# 31] load pretrained model from ./server/cp/SiamMask_DAVIS.pth
2023-04-19T22:13:08,284 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - load pretrained model from ./server/cp/SiamMask_DAVIS.pth
2023-04-19T22:13:09,277 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - remove prefix 'module.'
2023-04-19T22:13:09,277 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-19 22:13:09,277-rk0-load_helper.py# 25] remove prefix 'module.'
2023-04-19T22:13:09,278 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-19 22:13:09,278-rk0-load_helper.py# 18] used keys:356
2023-04-19T22:13:09,278 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - used keys:356
2023-04-19T22:13:09,318 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [2023-04-19 22:13:09,318] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.9.0, git-hash=unknown, git-branch=unknown
2023-04-19T22:13:09,319 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [2023-04-19 22:13:09,319] [INFO] [logging.py:96:log_dist] [Rank -1] quantize_bits = 8 mlp_extra_grouping = False, quantize_groups = 1
2023-04-19T22:13:09,320 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [2023-04-19 22:13:09,320] [INFO] [comm.py:570:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
2023-04-19T22:13:09,321 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Backend worker process died.
2023-04-19T22:13:09,321 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Traceback (most recent call last):
2023-04-19T22:13:09,321 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_service_worker.py", line 221, in <module>
2023-04-19T22:13:09,321 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     worker.run_server()
2023-04-19T22:13:09,321 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_service_worker.py", line 189, in run_server
2023-04-19T22:13:09,321 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     self.handle_connection(cl_socket)
2023-04-19T22:13:09,322 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_service_worker.py", line 154, in handle_connection
2023-04-19T22:13:09,322 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     service, result, code = self.load_model(msg)
2023-04-19T22:13:09,322 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_service_worker.py", line 118, in load_model
2023-04-19T22:13:09,322 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     service = model_loader.load(
2023-04-19T22:13:09,323 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/model_loader.py", line 135, in load
2023-04-19T22:13:09,323 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     initialize_fn(service.context)
2023-04-19T22:13:09,323 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/tmp/models/2dc519fc2172452fb5c1893911371a30/tshandler.py", line 52, in initialize
2023-04-19T22:13:09,323 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     siammask = deepspeed.init_inference(
2023-04-19T22:13:09,323 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/deepspeed/__init__.py", line 324, in init_inference
2023-04-19T22:13:09,324 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     engine = InferenceEngine(model, config=ds_inference_config)
2023-04-19T22:13:09,324 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/deepspeed/inference/engine.py", line 165, in __init__
2023-04-19T22:13:09,324 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     self._create_model_parallel_group(config)
2023-04-19T22:13:09,324 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/deepspeed/inference/engine.py", line 264, in _create_model_parallel_group
2023-04-19T22:13:09,324 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     init_distributed()
2023-04-19T22:13:11,087 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Listening on port: /tmp/.ts.sock.9000
2023-04-19T22:13:11,089 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Successfully loaded /home/vish/miniconda3/lib/python3.9/site-packages/ts/configs/metrics.yaml.
2023-04-19T22:13:11,089 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [PID]11338
2023-04-19T22:13:11,089 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Torch worker started.
2023-04-19T22:13:11,089 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Python runtime: 3.9.12
2023-04-19T22:13:11,090 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Connection accepted: /tmp/.ts.sock.9000.
2023-04-19T22:13:11,095 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - model_name: inpaint, batchSize: 1
