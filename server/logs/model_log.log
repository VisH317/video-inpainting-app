2023-04-18T19:07:57,675 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Listening on port: /tmp/.ts.sock.9000
2023-04-18T19:07:57,677 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Successfully loaded /home/vish/miniconda3/lib/python3.9/site-packages/ts/configs/metrics.yaml.
2023-04-18T19:07:57,678 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - [PID]24954
2023-04-18T19:07:57,678 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Torch worker started.
2023-04-18T19:07:57,678 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Python runtime: 3.9.12
2023-04-18T19:07:57,684 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Connection accepted: /tmp/.ts.sock.9000.
2023-04-18T19:07:57,698 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - model_name: inpaint, batchSize: 1
2023-04-18T19:07:59,743 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - LISTING DIR:  ['.gitignore', 'mask.py', 'tshandler.py', 'davis.py', 'predict.py', '.dockerignore', 'image', 'lib', 'demo_retarget.py', 'cp', 'model.py', 'E2FGVI', 'models', 'train_git.py', 'cog.yaml', 'test.py', 'get_mask', 'Dockerfile', 'serverREADME.md', 'requirements.txt', 'install.sh', 'server.py', 'logs', 'inpaint.py']
2023-04-18T19:07:59,743 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Created a temporary directory at /tmp/tmptv0k3zja
2023-04-18T19:07:59,743 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Writing /tmp/tmptv0k3zja/_remote_module_non_scriptable.py
2023-04-18T19:08:00,531 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - loading
2023-04-18T19:08:00,531 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:00,531-rk0-load_helper.py# 31] load pretrained model from ./server/cp/SiamMask_DAVIS.pth
2023-04-18T19:08:00,531 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - load pretrained model from ./server/cp/SiamMask_DAVIS.pth
2023-04-18T19:08:01,610 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:01,610-rk0-load_helper.py# 25] remove prefix 'module.'
2023-04-18T19:08:01,610 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - remove prefix 'module.'
2023-04-18T19:08:01,612 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:01,612-rk0-load_helper.py# 18] used keys:356
2023-04-18T19:08:01,612 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - used keys:356
2023-04-18T19:08:02,076 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - load pretrained SPyNet...
2023-04-18T19:08:02,076 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - load checkpoint from http path: https://download.openmmlab.com/mmediting/restorers/basicvsr/spynet_20210409-c6c1bd09.pth
2023-04-18T19:08:02,076 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Loading model from: ./server/E2FGVI/release_model/E2FGVI-HQ-CVPR22.pth
2023-04-18T19:08:07,726 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Backend received inference at: 1681859287
2023-04-18T19:08:07,726 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - LISTING DIR:  ['tshandler.py', '__pycache__', 'MAR-INF', 'server', 'server.zip']
2023-04-18T19:08:07,726 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - args:  Namespace(resume='cp/SiamMask_DAVIS.pth', mask_dilation=32, x=37, y=20, w=10368, h=5799, data=<_io.BytesIO object at 0x7f84bcbef630>)
2023-04-18T19:08:07,727 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - video file:  <_io.BytesIO object at 0x7f84bcbef630>
2023-04-18T19:08:09,027 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:09,026] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing template
2023-04-18T19:08:09,518 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:09,518] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing template
2023-04-18T19:08:10,032 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:10,032] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo done tracing template (RETURN_VALUE)
2023-04-18T19:08:10,038 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:10,038] torch._dynamo.output_graph: [INFO] Step 2: calling compiler function debug_wrapper
2023-04-18T19:08:10,409 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - hola:  79
2023-04-18T19:08:10,409 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - starting the inference
2023-04-18T19:08:10,409 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 0
2023-04-18T19:08:10,410 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - shape: (256, 256, 3)
2023-04-18T19:08:10,410 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (16005, 16005, 3)
2023-04-18T19:08:14,282 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:14,281] torch._inductor.compile_fx: [INFO] Step 3: torchinductor compiling FORWARDS graph 0
2023-04-18T19:08:14,349 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:14,349] torch._inductor.utils: [WARNING] DeviceCopy in input program
2023-04-18T19:08:22,942 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:22,942] torch._inductor.compile_fx: [INFO] Step 3: torchinductor done compiling FORWARDS graph 0
2023-04-18T19:08:22,944 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:22,943] torch._dynamo.output_graph: [INFO] Step 2: done compiler function debug_wrapper
2023-04-18T19:08:27,765 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:27,765] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing track_mask
2023-04-18T19:08:28,410 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:28,409] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo done tracing track_mask (RETURN_VALUE)
2023-04-18T19:08:28,418 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:28,417] torch._dynamo.output_graph: [INFO] Step 2: calling compiler function debug_wrapper
2023-04-18T19:08:33,209 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:33,209] torch._inductor.compile_fx: [INFO] Step 3: torchinductor compiling FORWARDS graph 1
2023-04-18T19:08:33,272 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:33,272] torch._inductor.utils: [WARNING] DeviceCopy in input program
2023-04-18T19:08:41,597 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:41,596] torch._inductor.compile_fx: [INFO] Step 3: torchinductor done compiling FORWARDS graph 1
2023-04-18T19:08:41,598 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:41,598] torch._dynamo.output_graph: [INFO] Step 2: done compiler function debug_wrapper
2023-04-18T19:08:41,771 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:41,771] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing track_refine
2023-04-18T19:08:41,804 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:41,804] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing forward
2023-04-18T19:08:41,826 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:41,825] torch._dynamo.output_graph: [INFO] Step 2: calling compiler function debug_wrapper
2023-04-18T19:08:41,883 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:41,883] torch._inductor.compile_fx: [INFO] Step 3: torchinductor compiling FORWARDS graph 2
2023-04-18T19:08:42,341 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:42,341] torch._inductor.compile_fx: [INFO] Step 3: torchinductor done compiling FORWARDS graph 2
2023-04-18T19:08:42,342 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:42,342] torch._dynamo.output_graph: [INFO] Step 2: done compiler function debug_wrapper
2023-04-18T19:08:42,353 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:42,353] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing <graph break in forward>
2023-04-18T19:08:42,371 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - /home/vish/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3737: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
2023-04-18T19:08:42,371 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG -   warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
2023-04-18T19:08:42,392 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - /home/vish/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3737: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
2023-04-18T19:08:42,392 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG -   warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
2023-04-18T19:08:42,410 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - /home/vish/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3737: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
2023-04-18T19:08:42,411 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG -   warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
2023-04-18T19:08:42,417 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:42,417] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo done tracing <graph break in forward> (RETURN_VALUE)
2023-04-18T19:08:42,419 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:42,419] torch._dynamo.output_graph: [INFO] Step 2: calling compiler function debug_wrapper
2023-04-18T19:08:42,440 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - /home/vish/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3737: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
2023-04-18T19:08:42,440 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG -   warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
2023-04-18T19:08:42,468 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - /home/vish/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3737: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
2023-04-18T19:08:42,469 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG -   warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
2023-04-18T19:08:42,516 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - /home/vish/miniconda3/lib/python3.9/site-packages/torch/nn/functional.py:3737: UserWarning: nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.
2023-04-18T19:08:42,516 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG -   warnings.warn("nn.functional.upsample is deprecated. Use nn.functional.interpolate instead.")
2023-04-18T19:08:42,724 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:42,724] torch._inductor.compile_fx: [INFO] Step 3: torchinductor compiling FORWARDS graph 3
2023-04-18T19:08:42,916 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:42,916] torch._inductor.compile_fx: [INFO] Step 3: torchinductor done compiling FORWARDS graph 3
2023-04-18T19:08:42,916 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:42,916] torch._dynamo.output_graph: [INFO] Step 2: done compiler function debug_wrapper
2023-04-18T19:08:42,926 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:42,925] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing <graph break in track_refine>
2023-04-18T19:08:43,068 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,068] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing track_refine
2023-04-18T19:08:43,102 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,102] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing forward
2023-04-18T19:08:43,125 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,124] torch._dynamo.output_graph: [INFO] Step 2: calling compiler function debug_wrapper
2023-04-18T19:08:43,182 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,182] torch._inductor.compile_fx: [INFO] Step 3: torchinductor compiling FORWARDS graph 4
2023-04-18T19:08:43,624 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,623] torch._inductor.compile_fx: [INFO] Step 3: torchinductor done compiling FORWARDS graph 4
2023-04-18T19:08:43,624 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,624] torch._dynamo.output_graph: [INFO] Step 2: done compiler function debug_wrapper
2023-04-18T19:08:43,802 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,802] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing track_refine
2023-04-18T19:08:43,836 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,836] torch._dynamo.symbolic_convert: [INFO] Step 1: torchdynamo start tracing forward
2023-04-18T19:08:43,859 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,859] torch._dynamo.output_graph: [INFO] Step 2: calling compiler function debug_wrapper
2023-04-18T19:08:43,917 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:43,917] torch._inductor.compile_fx: [INFO] Step 3: torchinductor compiling FORWARDS graph 5
2023-04-18T19:08:44,354 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:44,354] torch._inductor.compile_fx: [INFO] Step 3: torchinductor done compiling FORWARDS graph 5
2023-04-18T19:08:44,354 [WARN ] W-9000-inpaint_1-stderr MODEL_LOG - [2023-04-18 19:08:44,354] torch._dynamo.output_graph: [INFO] Step 2: done compiler function debug_wrapper
2023-04-18T19:08:45,363 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 1
2023-04-18T19:08:45,363 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (32136, 32136, 3)
2023-04-18T19:08:45,363 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 2
2023-04-18T19:08:45,363 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (1028, 1028, 3)
2023-04-18T19:08:45,363 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 3
2023-04-18T19:08:45,364 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (998, 998, 3)
2023-04-18T19:08:45,364 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 4
2023-04-18T19:08:45,364 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (965, 965, 3)
2023-04-18T19:08:45,364 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 5
2023-04-18T19:08:45,364 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (950, 950, 3)
2023-04-18T19:08:45,364 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 6
2023-04-18T19:08:45,365 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (934, 934, 3)
2023-04-18T19:08:45,365 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 7
2023-04-18T19:08:45,365 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (915, 915, 3)
2023-04-18T19:08:45,365 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 8
2023-04-18T19:08:45,365 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (908, 908, 3)
2023-04-18T19:08:45,365 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 9
2023-04-18T19:08:45,365 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (890, 890, 3)
2023-04-18T19:08:45,365 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 10
2023-04-18T19:08:45,366 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (901, 901, 3)
2023-04-18T19:08:45,366 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 11
2023-04-18T19:08:45,366 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - im patch original: (904, 904, 3)
2023-04-18T19:08:45,366 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - 11594.296396311
2023-04-18T19:08:45,366 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - SiamMask Time: 11594.3s Speed: 0.0fps (with visulization!)
2023-04-18T19:08:45,366 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Invoking custom service failed.
2023-04-18T19:08:45,366 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - Traceback (most recent call last):
2023-04-18T19:08:45,367 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/service.py", line 120, in predict
2023-04-18T19:08:45,368 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     ret = self._entry_point(input_batch, self.context)
2023-04-18T19:08:45,368 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/home/vish/miniconda3/lib/python3.9/site-packages/ts/torch_handler/base_handler.py", line 333, in handle
2023-04-18T19:08:45,368 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     output = self.inference(data_preprocess)
2023-04-18T19:08:45,368 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/tmp/models/a3264434ba42496aabbb972e3147cdd8/tshandler.py", line 98, in inference
2023-04-18T19:08:45,368 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     out = main_worker(self.model, self.size, args, self.device)
2023-04-18T19:08:45,368 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/tmp/models/a3264434ba42496aabbb972e3147cdd8/server/E2FGVI/test.py", line 164, in main_worker
2023-04-18T19:08:45,369 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     frames, size = resize_frames(frames, size)
2023-04-18T19:08:45,369 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/tmp/models/a3264434ba42496aabbb972e3147cdd8/server/E2FGVI/test.py", line 111, in resize_frames
2023-04-18T19:08:45,369 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     frames = [f.resize(size) for f in frames]
2023-04-18T19:08:45,369 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -   File "/tmp/models/a3264434ba42496aabbb972e3147cdd8/server/E2FGVI/test.py", line 111, in <listcomp>
2023-04-18T19:08:45,369 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG -     frames = [f.resize(size) for f in frames]
2023-04-18T19:08:45,369 [INFO ] W-9000-inpaint_1-stdout MODEL_LOG - TypeError: 'str' object cannot be interpreted as an integer
